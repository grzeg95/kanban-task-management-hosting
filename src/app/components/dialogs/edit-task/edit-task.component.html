<div class="app-edit-task__title">Edit BoardTask</div>

<form [formGroup]="form">

  <app-form-field>
    <app-label>Title</app-label>
    <app-input
      placeholder="e.g. Take coffee break"
      [withHint]="true"
      [formControl]="form.controls.title"
    />
    @if (!form.controls.title.valid && form.controls.title.touched && form.controls.title.errors?.['required']) {
      <app-error>Can’t be empty</app-error>
    }
  </app-form-field>

  <app-form-field>
    <app-label>Description</app-label>
    <app-textarea
      placeholder="e.g. It’s always good to take a break. This 15 minute break will  recharge the batteries a little."
      [withHint]="true"
      [formControl]="form.controls.description"
    />
  </app-form-field>

  <app-label>Subtasks</app-label>

  @for (subtask of form.controls.boardTaskSubtasks.controls; track subtask; let i = $index) {
    <app-form-field>
      <app-input
        [formControl]="subtask.controls.title"
        placeholder="e.g. Make coffee"
        [removeAble]="true"
        (remove)="form.controls.boardTaskSubtasks.removeAt(i)"
      />
    </app-form-field>
  }

  <button
    class="app-edit-task__add-new-subtask-button"
    app-button
    appearance="secondary"
    (click)="addNewBoardTaskSubtask()"
    [disabled]="form.disabled"
  >+ Add New BoardTaskSubtask
  </button>

  <app-form-field>
    <app-label>BoardStatus</app-label>
    <app-select
      placeholder="e.g. Take coffee break"
      [formControl]="form.controls.boardStatusId"
      [items]="boardStatusesPopMenuItems()"
      [withHint]="true"
    />
  </app-form-field>

  <button
    class="app-edit-task__update-task-button"
    app-button
    appearance="primary"
    (click)="updateTask()"
    [disabled]="form.disabled"
  >
    Save Changes
    @if (form.disabled) {
      <app-loader/>
    }
  </button>

</form>
